<!-- tradingFloor.wxml -->
<view class="tradingFloor">
  <!-- head bar -->
  <view class="headBar">
    <button class="headBar-btn-room" style="width: 120rpx" bindtap="onTapAdd" bindtap="onTapCancel" wx:if="{{keyword.length === 5}}">
      取消找寻
    </button>
    <button class="headBar-btn-room" style="width: 120rpx" bindtap="onTapAdd" bindtap="modalOpen" wx:else>
      找寻
    </button>
    <button class="headBar-btn-room" style="width: 120rpx" bindtap="onTapCreate">开岛</button>
    <button class="headBar-btn-order {{order=='createTime'?'headBar-btn-order-active':''}}" style="width: 120rpx" bindtap="onTapTime">
      时间排序
    </button>
    <button class="headBar-btn-order {{order=='price'?'headBar-btn-order-active':''}}" style="width: 120rpx" bindtap="onTapPrice">
      价格排序
    </button>
  </view>
  <!-- info board -->
  <view class="board">
    <!-- if db has data show cards, else show words -->
    <block wx:if="{{cards.length>0&&isLoading===false}}">
      <block wx:for="{{cards}}" wx:for-item="item" wx:key="cards">
        <!-- Here Cards for Flight -->
        <view class="card">
          <image class="boardingpass" src="../../assets/boardingpass/boardingpassPink.png" mode="widthFix" />
          <view class="card-number">{{item.roomNum}}</view>
          <view id="{{item._id}}" class="card-box-shader" bindtap="onTapCard">
            <view class="card-box {{item._id===curTool_id?'slide-right':''}} {{item._id===preTool_id?'slide-left':''}}">
              <view class="card-main">
                <view class="card-main-des">To {{item.master.gameProfile.islandName}}</view>
                <view class="card-main-time">还剩{{item.time}}小时</view>
                <view class="card-main-note">{{item.note}}</view>
                <view class="card-main-barcode">
                  <image src="../../assets/boardingpass/barcode.gif" style="height:60rpx" mode="heightFix" />
                </view>
              </view>
              <view class="card-sub">
                <view class="card-sub-price">
                  <image class="card-sub-price-icon" src="../../assets/icons/bell.png" mode="heightFix" />
                  <view class="card-sub-price-text">{{item.price}}</view>
                </view>
                <view class="card-sub-lineinfo">排队1/1</view>
              </view>
              <view class="card-tools">
                <view class="card-tools-join" id="{{item._id}}" bindtap="onTapJoin">
                  <image class="card-tools-icon" src="../../assets/icons/AddIcon.png" mode="heightFix" />
                  <button class="card-tools-btn" style="width: 20vw;  paddding: 0rpx;">加入</button>
                </view>
                <view class="card-tools-share" style="width:100%;">
                  <button style="margin:0 0; padding: 0 0; width:100%; height:60%; background-color:rgba(0,0,0,0);" open-type="share" data-roomnum="{{item.roomNum}}" data-id="{{item._id}}">
                    <image class="card-tools-icon" style="height:100%" src="../../assets/icons/ShareIcon.png" mode="heightFix" />
                  </button>
                  <view class="card-tools-btn">分享</view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </block>
      <view class="card-bottom" style="line-height: {{isBottomLoading?'65rpx':'50rpx'}};">
        <block wx:if="{{isBottomLoading}}">
          <image class="card-bottom-loading" src="../../assets/icons/EarthLoading.gif" mode="widthFix" />
          <text>加载更多...</text>
        </block>
        <block wx:else>
          <text>---</text>
          <text style="margin-left: 20rpx">到底啦~！</text>
          <image class="card-bottom-nook" src="../../assets/icons/nook.png" mode="widthFix" style="margin-right: 20rpx" />
          <text>---</text>
        </block>
      </view>
    </block>
    <block wx:elif="{{cards.length===0&&isLoading===false}}">
      <view class="notFound">
        <text>找不到？！试试下拉刷新~！</text>
        <image class="notFound-nook" src="../../assets/icons/nook.png" mode="widthFix" />
      </view>
    </block>
    <image class="loadingGIF" src="../../assets/icons/EarthLoading.gif" mode="widthFix" wx:if="{{isLoading}}" />
  </view>
  <!-- mask -->
  <view class='mask' wx:if="{{showModal}}" bindtap='modalHide' />
  <!-- modal -->
  <view class='mymodal' wx:if="{{showModal}}">
    <image class="modal-img" src="../../assets/roomJoinModal.png" mode="widthFix" />
    <image class="modal-inputImg" src="../../assets/inputBar.png" mode="widthFix" />
    <input class="modal-inputBar" value="{{keyword}}" maxlength="5" bindinput="bindSearchBar" />
    <button class="modal-btn" style="width: 120rpx; left:230rpx" bindtap="modalHide">返回</button>
    <button class="modal-btn" style="width: 120rpx; left:410rpx" disabled="{{keyword.length===5?false:true}}" bindtap="onTapSearch">
      搜索
    </button>
  </view>
</view>